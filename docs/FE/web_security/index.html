<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-FE/web_security">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">浏览器安全 | Aki Huang 🤔👊💪✍️👀👨‍💻‍</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://huangzonggui.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://huangzonggui.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://huangzonggui.github.io/docs/FE/web_security"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="浏览器安全 | Aki Huang 🤔👊💪✍️👀👨‍💻‍"><meta data-rh="true" name="description" content="浏览器安全可分为"><meta data-rh="true" property="og:description" content="浏览器安全可分为"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://huangzonggui.github.io/docs/FE/web_security"><link data-rh="true" rel="alternate" href="https://huangzonggui.github.io/docs/FE/web_security" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://huangzonggui.github.io/docs/FE/web_security" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.eb714823.css">
<link rel="preload" href="/assets/js/runtime~main.0a49b4b1.js" as="script">
<link rel="preload" href="/assets/js/main.079b6d6f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">A.H</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/FE/browser/Navigation_URL">文章</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/huangzonggui/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/FE/browser/Navigation_URL">前端</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/FE/browser/Navigation_URL">浏览器原理</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/React_Base">React基础知识和原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Vue_20211130">Vue实现与原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/performance_first_try">Web 性能优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/JS_Base">JavaScript 基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/HTML_CSS">HTML CSS 基础知识总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/HTTP">HTTP 超文本传输协议相关知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/FE/web_security">浏览器安全</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/webpackAndBabel">webpack 和 Babel 常用的基本配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Seven_Day">前端八股文</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Auth">关于鉴权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/CSS_Layout">圣杯布局与双飞翼布局</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/PNPM_Yarn_npm">pnpm yarn npm 包管理工具区别</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Select">知识储备与技术选型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Study">学习推荐资料</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/System">前端工程化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/Theme">主题方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/npm_module_privatization">项目模块化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/FE/wechatMiniProgram">wechatMiniProgram</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Review/interview">复盘</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/DataStructuresAndAlgorithms/120401">算法</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Other/tool">其他</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Think/images">思考🤔</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/kaoyan/base">kaoyan</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">前端</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">浏览器安全</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>浏览器安全</h1></header><p>浏览器安全可分为</p><ul><li>Web 页面安全</li><li>浏览器网络安全</li><li>浏览器系统安全</li></ul><h1>Web 页面安全</h1><p>同源策略、CSP(Content-Security-Policy) 和 CORS(Cross-Origin Resource Sharing) 之间的关系</p><ul><li>同源策略是浏览器的一个安全机制，使用 XMLHttpRequest 和 Fetch 都是无法直接进行跨域请求的，
但是页面可以引用第三方资源（如：img，js，css，html），这样就会暴露一些 XSS 攻击的安全。CSP 是浏览器为了解决 XSS 攻击引入的一个安全策略<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- CSP 核心思想：让服务器决定浏览器能够加载哪些资源，决定浏览器是否能够执行内联 JavaScript 代码</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>XMLHttpRequest 和 fetch 是无法访问不同域的数据的，因此浏览器又引入了 CORS(跨域资源共享)策略，让其可以安全的进行跨域操作<ul><li>服务器配置 Access-Control-Origin-Allow: 允许跨域的域名</li></ul></li></ul><p>同源策略、CSP 和 CORS 之间的关系：</p><p>同源策略就是说同源页面随你瞎搞，但是不同源之间想瞎搞只能通过浏览器提供的手段来搞</p><p>比如说</p><ol><li>读取数据和操作 DOM 要用跨文档机制(window.postMessage)</li><li>跨域请求要用 CORS 机制</li><li>引用第三方资源要用 CSP</li></ol><p>通俗点，同源策略为了防止</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="跨站脚本xss-cross-site-scripting攻击">跨站脚本（XSS: Cross Site Scripting）攻击<a href="#跨站脚本xss-cross-site-scripting攻击" class="hash-link" aria-label="跨站脚本（XSS: Cross Site Scripting）攻击的直接链接" title="跨站脚本（XSS: Cross Site Scripting）攻击的直接链接">​</a></h2><p>恶意脚本可以做</p><ul><li>通过<code>document.cookie</code>窃取 Cookie 信息。做一些登录后的恶意操作。</li><li>通过<code>addEventListener</code>监听键盘的输入。例如窃取信用卡账号和密码并发送到黑客服务器。</li><li>通过<code>修改 DOM</code>伪造登录窗口，欺骗用户名和密码等信息。</li><li>嵌入浮窗广告。</li></ul><p>分类</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="存储型-xss-攻击涉及服务器">存储型 XSS 攻击（涉及服务器）<a href="#存储型-xss-攻击涉及服务器" class="hash-link" aria-label="存储型 XSS 攻击（涉及服务器）的直接链接" title="存储型 XSS 攻击（涉及服务器）的直接链接">​</a></h3><p>攻击步骤</p><ol><li>将恶意代码提交到<strong>服务器数据库</strong>中存储（例如通过表单输入脚本代码）</li><li>页面请求第一步提交的数据，数据库返回恶意代码</li><li>用户浏览此页面时，恶意代码会运行（将用户的 Cookie 信息等数据上传到攻击者服务器）。</li></ol><p>预防</p><ol><li>对 Cookie 设置 httpOnly ，只允许 http 请求使用，document.cookie 无法获取</li><li>在前端后端提交数据和保存数据的时候，将数据过滤或转码，脚本的代码会转成普通的字符串</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="反射型-xss-攻击涉及服务器">反射型 XSS 攻击（涉及服务器）<a href="#反射型-xss-攻击涉及服务器" class="hash-link" aria-label="反射型 XSS 攻击（涉及服务器）的直接链接" title="反射型 XSS 攻击（涉及服务器）的直接链接">​</a></h3><p>Web 服务器接收到请求时，又将恶意代码<strong>反射</strong>给了浏览器端</p><ol><li>攻击者通过将恶意代码构造到特殊的 URL中</li><li>用户点击 URL，服务器将恶意代码从 URL 中取出拼接在 HTML 中返回给浏览器</li><li>用户解析 HTML 执行，恶意代码被执行</li><li>恶意代码将用户信息发送到攻击者服务器，或者冒充用户的行为，恶意调用目标网站接口执行攻击者指定的操作</li></ol><blockquote><p>反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。</p></blockquote><p>预防</p><ol><li>对内容进行过滤或转码</li><li>利用 CSP(Content-Security-Policy)，控制浏览器能够加载哪些资源，决定浏览器只能够执行内联 JavaScript 代码<ul><li>限制加载其他域下的资源文件 eg: <code>Content-Security-Policy: default-src &#x27;self&#x27;</code></li><li>禁止第三方域提交数据，防止用户数据泄露</li><li>禁止执行内联脚本和未授权的脚本</li><li>提供了上报机制，可尽快发现 XSS 攻击</li></ul></li><li>使用 HttpOnly 属性</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="基于-dom-的-xss-攻击不涉及服务器">基于 DOM 的 XSS 攻击（不涉及服务器）<a href="#基于-dom-的-xss-攻击不涉及服务器" class="hash-link" aria-label="基于 DOM 的 XSS 攻击（不涉及服务器）的直接链接" title="基于 DOM 的 XSS 攻击（不涉及服务器）的直接链接">​</a></h3><p>在 Web 资源传输过程中，修改 HTML 页面（网络劫持）</p><ul><li>通过 WiFi 路由器劫持</li><li>通过本地恶意软件劫持</li></ul><p>预防 DOM 型 XSS 攻击</p><ul><li>使用 <code>.innerHTML</code>、<code>.outerHTML</code>、<code>document.write</code> 时确保数据可信</li><li>避免在字符串中拼接不可信数据</li></ul><p>实践: 安全检测报告
<img loading="lazy" src="/assets/images/2022-02-22-11-26-00-7393a8dd31bc49c067bd35e253007900.png" width="648" height="821" class="img_ev3q"></p><p>安全检测工具：<a href="https://www.zaproxy.org/" target="_blank" rel="noopener noreferrer">https://www.zaproxy.org/</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xss-攻击总结">XSS 攻击总结<a href="#xss-攻击总结" class="hash-link" aria-label="XSS 攻击总结的直接链接" title="XSS 攻击总结的直接链接">​</a></h3><blockquote><p>这三种攻击方式的共同点是都需要往用户的页面中注入恶意脚本，然后再通过恶意脚本将用户数据上传到黑客的恶意服务器上。而三者的不同点在于注入的方式不一样，有通过服务器漏洞来进行注入的，还有在客户端直接注入的。</p></blockquote><blockquote><p>主要有三种防范策略，第一种是通过服务器对输入的内容进行过滤或者转码，第二种是充分利用好 CSP，第三种是使用 HttpOnly 来保护重要的 Cookie 信息。</p></blockquote><p>转账等安全性要求高的操作，通过<strong>添加验证码</strong>添加安全性</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="跨站请求伪造csrf-cross-site-request-forgery">跨站请求伪造（CSRF: Cross-site request forgery）<a href="#跨站请求伪造csrf-cross-site-request-forgery" class="hash-link" aria-label="跨站请求伪造（CSRF: Cross-site request forgery）的直接链接" title="跨站请求伪造（CSRF: Cross-site request forgery）的直接链接">​</a></h2><p><strong>什么是 CSRF 攻击</strong></p><p>攻击者诱导用户打开第三方网站（攻击者网站），在第三方网站中通过伪造请求登录网站，从而利用用户的<strong>登录状态</strong>发起跨站请求，做一些恶意行为。</p><p>为什么从登录的网站打开第三方网站，第三方可以使用到登录网站的登录状态？</p><ul><li>没设置 SameSite 情况下，登录站点A.com后（此时有登录状态）</li><li>诱导跳转到站点B，站点B中做了一些向A.com站点请求的伪造请求（img 或 form的请求，这些请求不受跨域限制）：A.com/act=xxx。此时浏览器会默认携带 A.com 的登录状态（Cookie）
（浏览器处理cookie的机制，做某个域的请求，自动会把这个域的cookie带上） </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-类型的-csrf">GET 类型的 CSRF<a href="#get-类型的-csrf" class="hash-link" aria-label="GET 类型的 CSRF的直接链接" title="GET 类型的 CSRF的直接链接">​</a></h3><p>在攻击者页面的 HTML 代码中，将恶意请求隐藏在 <code>img</code> 标签内，当页面加载时，自动发起 <code>Get</code> 请求</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="post-类型的-csrf">POST 类型的 CSRF<a href="#post-类型的-csrf" class="hash-link" aria-label="POST 类型的 CSRF的直接链接" title="POST 类型的 CSRF的直接链接">​</a></h3><p>在攻击者页面的 HTML 代码中，将恶意请求伪造在 <code>form</code> 标签中，用脚本提交 <code>document.getElementById(&#x27;form&#x27;).submit()</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="诱导用户点击链接类型的-csrf">诱导用户点击链接类型的 CSRF<a href="#诱导用户点击链接类型的-csrf" class="hash-link" aria-label="诱导用户点击链接类型的 CSRF的直接链接" title="诱导用户点击链接类型的 CSRF的直接链接">​</a></h3><p>在攻击者页面中，防止一个诱导 A 标签，实际 <code>href</code> 是攻击操作。需要用户点击链接才会触发</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">a href</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;http://test.com/csrf/withdraw.php?amount=1000&amp;for=hacker&quot;</span><span class="token plain"> taget</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;_blank&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  重磅消息！！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="预防">预防<a href="#预防" class="hash-link" aria-label="预防的直接链接" title="预防的直接链接">​</a></h3><p>CSRF 的特点</p><ul><li>CSRF (通常)发生在第三方域名</li><li>CSRF 攻击者不能窃取到 Cookie 信息，只是使用</li></ul><p>针对 CSRF 的特点，指定防护策略：</p><ul><li>阻止不明外域访问<ul><li>同源检测</li><li>Samesite Cookie</li></ul></li><li>提交时要求附加本域才能获取到的信息<ul><li>CSRF Token</li><li>双重 Cookie 验证</li></ul></li></ul><p><strong>具体策略</strong></p><ol><li><p>利用 Cookie 的 SameSite 属性</p><ul><li><code>SameSite=Strict</code> 浏览器完全禁止第三方 <code>Cookie</code><blockquote><p>如果你从极客时间的页面中访问 InfoQ 的资源
，而 InfoQ 的某些 Cookie 设置了 SameSite = Strict 的话，
那么这些 Cookie 是不会被发送到 InfoQ 的服务器上的。
只有你从 InfoQ 的站点去请求 InfoQ 的资源时，才会带上这些 Cookie。</p></blockquote></li><li><code>SameSite=Lax</code> <blockquote><p>在跨站点的情况下，从第三方站点的链接打开和从第三方站点提交 Get 方式的表单这两种方式都会携带 Cookie。但如果在第三方站点中使用 Post 方法，或者通过 img、iframe 等标签加载的 URL，这些场景都不会携带 Cookie。</p></blockquote></li><li><code>SameSite=none</code> 在任意情况都会发送 Cookie 数据  </li></ul></li><li><p>服务器验证请求的来源站点</p><blockquote><p>Referer 是 HTTP 请求头中的一个字段，记录了该 HTTP 请求的来源地址</p></blockquote></li></ol><p><img loading="lazy" src="/assets/images/2022-02-22-21-55-15-d96b52fe23d9d5f154d0dfde45b33ab1.png" width="1356" height="764" class="img_ev3q"></p><blockquote><p>Origin 属性只包含了域名信息，并没有包含具体的 URL 路径，这是 Origin 和 Referer 的一个主要区别
Origin 的值之所以不包含详细路径信息，是有些站点因为安全考虑，不想把源站点的详细路径暴露给服务器。</p></blockquote><p>服务器的策略是优先判断 Origin，如果请求头中没有包含 Origin 属性，再根据实际情况判断是否使用 Referer 值</p><ol start="3"><li>CSRF Token<ul><li>浏览器向服务器发起请求，服务器返回一个 CSRF Token，植入到页面中</li><li>浏览器如果要发起类似“转账”类的请求，需要携带 CSRF Token，服务器验证 Token 是否合法。
<img loading="lazy" src="/assets/images/2022-02-22-22-06-57-926d1b8a5dbb48bb65c8e383b59ecf23.png" width="2408" height="1272" class="img_ev3q"></li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-网页安全总结">Web 网页安全总结<a href="#web-网页安全总结" class="hash-link" aria-label="Web 网页安全总结的直接链接" title="Web 网页安全总结的直接链接">​</a></h2><p>Web 安全问题主要原因是浏览器为<strong>同源策略</strong>开的两个后门</p><ul><li>页面中可以任意引用第三方资源</li><li>通过 CORS 策略让 XMLHttpRequest 和 Fetch 去跨域请求资源</li></ul><p>为了解决这些问题</p><ul><li>引入了 <code>CSP</code> 来限制页面任意引入外部资源</li><li>引入了 <code>HttpOnly</code> 机制来禁止 <code>JavaScript</code> 通过 <code>document.cookies</code> 的读取</li><li>引入了 <code>SameSite</code> 和 <code>Origin</code> 来防止 <code>CSRF</code> 攻击</li></ul><h1>浏览器系统安全</h1><p>参考文章：</p><ul><li><a href="https://time.geekbang.org/column/article/151370" target="_blank" rel="noopener noreferrer">32 | 同源策略：为什么XMLHttpRequest不能跨域请求资源？</a></li><li><a href="https://time.geekbang.org/column/article/152807" target="_blank" rel="noopener noreferrer">33 | 跨站脚本攻击（XSS）：为什么Cookie中有HttpOnly属性？</a></li><li><a href="https://time.geekbang.org/column/article/154110" target="_blank" rel="noopener noreferrer">34 | CSRF攻击：陌生链接不要随便点</a></li><li><a href="https://tech.meituan.com/2018/09/27/fe-security.html" target="_blank" rel="noopener noreferrer">前端安全系列（一）：如何防止XSS攻击</a></li><li><a href="https://tech.meituan.com/2018/10/11/fe-security-csrf.html" target="_blank" rel="noopener noreferrer">前端安全系列（二）：如何防止CSRF攻击？</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/安全">安全</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/FE/HTTP"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">HTTP 超文本传输协议相关知识</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/FE/webpackAndBabel"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">webpack 和 Babel 常用的基本配置</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#跨站脚本xss-cross-site-scripting攻击" class="table-of-contents__link toc-highlight">跨站脚本（XSS: Cross Site Scripting）攻击</a><ul><li><a href="#存储型-xss-攻击涉及服务器" class="table-of-contents__link toc-highlight">存储型 XSS 攻击（涉及服务器）</a></li><li><a href="#反射型-xss-攻击涉及服务器" class="table-of-contents__link toc-highlight">反射型 XSS 攻击（涉及服务器）</a></li><li><a href="#基于-dom-的-xss-攻击不涉及服务器" class="table-of-contents__link toc-highlight">基于 DOM 的 XSS 攻击（不涉及服务器）</a></li><li><a href="#xss-攻击总结" class="table-of-contents__link toc-highlight">XSS 攻击总结</a></li></ul></li><li><a href="#跨站请求伪造csrf-cross-site-request-forgery" class="table-of-contents__link toc-highlight">跨站请求伪造（CSRF: Cross-site request forgery）</a><ul><li><a href="#get-类型的-csrf" class="table-of-contents__link toc-highlight">GET 类型的 CSRF</a></li><li><a href="#post-类型的-csrf" class="table-of-contents__link toc-highlight">POST 类型的 CSRF</a></li><li><a href="#诱导用户点击链接类型的-csrf" class="table-of-contents__link toc-highlight">诱导用户点击链接类型的 CSRF</a></li><li><a href="#预防" class="table-of-contents__link toc-highlight">预防</a></li></ul></li><li><a href="#web-网页安全总结" class="table-of-contents__link toc-highlight">Web 网页安全总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://juejin.cn/user/870468940997319" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/huangzonggui/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.0a49b4b1.js"></script>
<script src="/assets/js/main.079b6d6f.js"></script>
</body>
</html>