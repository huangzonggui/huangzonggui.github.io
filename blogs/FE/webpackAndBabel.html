<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 和 Babel 常用的基本配置 | Aki Huang 🤔👊💪✍️👀👨‍💻‍ </title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="让正确的事情持续发生">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.37f5b436.css" as="style"><link rel="preload" href="/assets/js/app.3531c93d.js" as="script"><link rel="preload" href="/assets/js/3.4482be46.js" as="script"><link rel="preload" href="/assets/js/1.336ca81d.js" as="script"><link rel="preload" href="/assets/js/27.bdf61d24.js" as="script"><link rel="prefetch" href="/assets/js/10.0315f031.js"><link rel="prefetch" href="/assets/js/11.523a3cda.js"><link rel="prefetch" href="/assets/js/12.e8b710d0.js"><link rel="prefetch" href="/assets/js/13.39f21269.js"><link rel="prefetch" href="/assets/js/14.2a7a8f7f.js"><link rel="prefetch" href="/assets/js/15.91f52669.js"><link rel="prefetch" href="/assets/js/16.817b068a.js"><link rel="prefetch" href="/assets/js/17.ecbcc7d8.js"><link rel="prefetch" href="/assets/js/18.c4e63641.js"><link rel="prefetch" href="/assets/js/19.62d8e109.js"><link rel="prefetch" href="/assets/js/20.a611cb8e.js"><link rel="prefetch" href="/assets/js/21.48d1ac96.js"><link rel="prefetch" href="/assets/js/22.89820343.js"><link rel="prefetch" href="/assets/js/23.079b8ce7.js"><link rel="prefetch" href="/assets/js/24.7b4ce0c2.js"><link rel="prefetch" href="/assets/js/25.48aaef8c.js"><link rel="prefetch" href="/assets/js/26.975bc96f.js"><link rel="prefetch" href="/assets/js/28.7bfd9909.js"><link rel="prefetch" href="/assets/js/29.7d4476f7.js"><link rel="prefetch" href="/assets/js/30.f7c6ab04.js"><link rel="prefetch" href="/assets/js/4.204ff8fe.js"><link rel="prefetch" href="/assets/js/5.aa419d1d.js"><link rel="prefetch" href="/assets/js/6.fc07ecd3.js"><link rel="prefetch" href="/assets/js/7.fb2132c5.js"><link rel="prefetch" href="/assets/js/8.5ac82d32.js"><link rel="prefetch" href="/assets/js/9.7926ce2f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.37f5b436.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Aki Huang 🤔👊💪✍️👀👨‍💻‍ </h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>让正确的事情持续发生</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Aki Huang</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Aki Huang 🤔👊💪✍️👀👨‍💻‍ " class="logo"> <span class="site-name">Aki Huang 🤔👊💪✍️👀👨‍💻‍ </span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Data Structures and Algorithms/" class="nav-link"><i class="undefined"></i>
  Data Structures and Algorithms
</a></li><li class="dropdown-item"><!----> <a href="/categories/FrontEnd/" class="nav-link"><i class="undefined"></i>
  FrontEnd
</a></li><li class="dropdown-item"><!----> <a href="/categories/Think/" class="nav-link"><i class="undefined"></i>
  Think
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/huangzonggui/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="huangzonggui huangzonggui-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/870468940997319" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="huangzonggui huangzonggui-juejin"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    Aki Huang
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>18</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>20</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/Data Structures and Algorithms/" class="nav-link"><i class="undefined"></i>
  Data Structures and Algorithms
</a></li><li class="dropdown-item"><!----> <a href="/categories/FrontEnd/" class="nav-link"><i class="undefined"></i>
  FrontEnd
</a></li><li class="dropdown-item"><!----> <a href="/categories/Think/" class="nav-link"><i class="undefined"></i>
  Think
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/huangzonggui/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="huangzonggui huangzonggui-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/870468940997319" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="huangzonggui huangzonggui-juejin"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>webpack 和 Babel 常用的基本配置</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Aki Huang</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">webpack 和 Babel 常用的基本配置</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>Aki Huang</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>3/28/2021</span></i> <i class="iconfont reco-eye" data-v-1ff7123e><span id="/blogs/FE/webpackAndBabel.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-1ff7123e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>webpack</span><span class="tag-item" data-v-1ff7123e>babel</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h1> <p>成熟的工具，重点在于配置、使用、性能优化，原理不是高优</p> <h2 id="为什么需要webpack-webpack作用"><a href="#为什么需要webpack-webpack作用" class="header-anchor">#</a> 为什么需要webpack? webpack作用</h2> <ul><li>优化打包效率</li> <li>优化打包后代码： 压缩代码，整合代码，以网页加载更快</li> <li>工程化，构建流程</li></ul> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5e9cfe2ef31b4646b06c57e650b40b06~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h2 id="🤔思考问题"><a href="#🤔思考问题" class="header-anchor">#</a> 🤔思考问题</h2> <ul><li>module chunk bundle 分别是什么意思？有何区别？</li> <li>loader和plugin的区别？</li> <li>webpack如何实现懒加载</li> <li>babel-runtime 和 babel-polyfill的区别</li></ul> <h2 id="关于webpack5"><a href="#关于webpack5" class="header-anchor">#</a> 关于webpack5</h2> <ul><li>webpack5主要是内部效率的优化</li> <li>对比webpack4没有太多的使用上的改动
<ul><li>https://webpack.docschina.org/blog/2020-10-10-webpack-5-release/</li></ul></li> <li>升级webpack5的同时注意升级周边插件</li></ul> <h2 id="基本配置"><a href="#基本配置" class="header-anchor">#</a> 基本配置</h2> <h3 id="安装配置"><a href="#安装配置" class="header-anchor">#</a> 安装配置</h3> <p>初始化安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install webpack webpack-cli html-webpack-plugin webpack-dev-server -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>打包命令</p> <ul><li>webpack</li></ul> <h3 id="拆分配置和merge"><a href="#拆分配置和merge" class="header-anchor">#</a> 拆分配置和merge</h3> <ul><li>webpack.common.js 公共配置</li> <li>webpack.dev.js 开发环境</li> <li>webpack.prod.js 生产环境</li></ul> <h3 id="启动本地服务-dev-server-命令"><a href="#启动本地服务-dev-server-命令" class="header-anchor">#</a> 启动本地服务 dev-server 命令</h3> <ul><li>webpack-dev-server(webpack4)</li> <li>webpack serve(webpack5)</li></ul> <h3 id="module"><a href="#module" class="header-anchor">#</a> Module</h3> <h4 id="rule"><a href="#rule" class="header-anchor">#</a> rule</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
	rules<span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token comment">//Include all modules that pass test assertion.</span>
			use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        include<span class="token operator">:</span> srcPath<span class="token punctuation">,</span>
			exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span>
		<span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="解析es6-编译为es5"><a href="#解析es6-编译为es5" class="header-anchor">#</a> 解析ES6 -&gt; 编译为ES5</h4> <p>修改配置文件<code>.babelrc</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
    &quot;presets&quot;: [&quot;@babel/preset-env&quot;]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>@babel/preset-env</code> 是 babel 7 架構下的一組 preset，<strong>能讓你用最新的 JavaScript 語法寫程式，並且智慧地根據瀏覽器的環境引入需要的 polyfill</strong>，節省手動管理 syntax transform 的時間，還能夠減少 bundle 檔案大小</p> <h3 id="devserver"><a href="#devserver" class="header-anchor">#</a> <a href="https://webpack.docschina.org/configuration/dev-server/" target="_blank" rel="noopener noreferrer">devServer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <ul><li>compress
<ul><li>启动gzip compressinon</li></ul></li> <li>hot
<ul><li>启用 webpack 的 热模块替换 特性</li></ul></li> <li>open
<ul><li>告诉 dev-server 在服务器已经启动后打开浏览器。</li></ul></li> <li>port
<ul><li>指定监听请求的端口号</li></ul></li> <li>proxy
<ul><li>代理 解决开发时的跨域问题
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05757715efd149a1b265de1e2cfae44a~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></li></ul></li></ul> <h3 id="解析图片文件"><a href="#解析图片文件" class="header-anchor">#</a> 解析图片文件</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// import img</span>
<span class="token keyword">function</span> <span class="token function">insertImgElem</span><span class="token punctuation">(</span><span class="token parameter">imgFile</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
	<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	img<span class="token punctuation">.</span>src <span class="token operator">=</span> imgFile<span class="token punctuation">;</span>
	document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">import</span> imgFile1 <span class="token keyword">from</span> <span class="token string">'./img/1.png'</span><span class="token punctuation">;</span>
<span class="token function">insertImgElem</span><span class="token punctuation">(</span>imgFile1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> imgFile2 <span class="token keyword">from</span> <span class="token string">'./img/2.jpeg'</span><span class="token punctuation">;</span>
<span class="token function">insertImgElem</span><span class="token punctuation">(</span>imgFile2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong><code>Image()</code></strong> 函数将会创建一个新的<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLImageElement" target="_blank" rel="noopener noreferrer"><code>HTMLImageElement</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>实例。</p> <p>它的功能等价于 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/createElement" title="document.createElement('img')" target="_blank" rel="noopener noreferrer"><code>document.createElement('img')</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>webpack配置</p> <ol><li></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i -D file-loader 
<span class="token function">npm</span> i -D url-loader 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>webpack.dev.js</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpeg|jpg|git)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token string">'file-loader'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="3"><li>webpack.prod.js</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpeg|jpg|git)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">{</span>
                loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 小于 5kb 的图片 base64 格式产出</span>
                    <span class="token comment">// 否侧 依然用 file-loader 的形式，产出 url 格式</span>
                    limit<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
                    <span class="token comment">// 打包到 img 目錄下</span>
                    outputPath<span class="token operator">:</span> <span class="token string">'/img1'</span><span class="token punctuation">,</span>
                    <span class="token comment">// 設置圖片的cdn地址</span>
                    <span class="token comment">// publicPath: 'https://cdn.abc.com'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>效果</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d5058eea62e4075ac9dc0e868266855~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <p>好处：图片小 用base64 减少一次http请求 减少耗时</p> <h3 id="常见loader和plugin"><a href="#常见loader和plugin" class="header-anchor">#</a> 常见loader和plugin</h3> <h3 id="处理样式文件"><a href="#处理样式文件" class="header-anchor">#</a> 处理样式文件</h3> <ul><li>postcss-loader</li> <li>less-loader</li> <li>css-loader</li> <li>style-loader</li></ul> <blockquote><p>npm i -D postcss-loader less-loader css-loader style-loader</p></blockquote> <p>配置 webpack.common.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token comment">// loader 的执行顺序是： 从后往前</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span><span class="token comment">// 加了postcss</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token comment">// 增加 ‘less-loader',注意顺序</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>postcss-loader中配置自动生成前缀postcss.config.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>transform: rotate(-45deg)</code> 自动添加前缀的效果
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fbde75249d944eecb0226652521740e7~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h2 id="高级配置"><a href="#高级配置" class="header-anchor">#</a> 高级配置</h2> <h3 id="配置多入口"><a href="#配置多入口" class="header-anchor">#</a> 配置多入口</h3> <p>虽然说现在的项目都是SPA(单页面应用)，但项目有时候需要产出多个页面</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token comment">// 多入口 - 生成 index.html</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>srcPath<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
			<span class="token comment">// chunks 表示该页面要引用哪些 chunk （即上面的 index 和 other），默认全部引用</span>
			chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">]</span>  <span class="token comment">// 只引用 index.js</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token comment">// 多入口 - 生成 other.html</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>srcPath<span class="token punctuation">,</span> <span class="token string">'other.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			filename<span class="token operator">:</span> <span class="token string">'other.html'</span><span class="token punctuation">,</span>
			chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'other'</span><span class="token punctuation">]</span>  <span class="token comment">// 只引用 other.js</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/882f23e1431b4156a7b349cba008e709~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1da18398d4fc459993565d5953a69b0b~tplv-k3u1fbpfcp-watermark.image?" alt="image.png">
打包输出</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3b7065c5b594080bfa53003c87b18ac~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="抽离和压缩css-重要"><a href="#抽离和压缩css-重要" class="header-anchor">#</a> 抽离和压缩CSS(重要)</h3> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/090d5afa47224a0b9986cedb0b84bf9b~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="抽离公共代码-重要"><a href="#抽离公共代码-重要" class="header-anchor">#</a> 抽离公共代码(重要)</h3> <ul><li><p>为什么需要抽离公共代码和第三方代码？</p> <ul><li>当引入第三方库时，如果不独立打包，每次修改业务逻辑代码，都会重新打包第三方库，导致加载慢。</li> <li>两个文件引入了同一个模块，会打包两次</li></ul></li> <li><p>配置为独立的chunks</p></li></ul> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f93a2c82696341d5a0daeafc957f2ad4~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="webpack如何实现异步加载js-懒加载-重要"><a href="#webpack如何实现异步加载js-懒加载-重要" class="header-anchor">#</a> webpack如何实现异步加载JS(懒加载)(重要)</h3> <p>默认支持的语法，不用配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
	<span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">'./danymic.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">// 打包时会独立成一个chunk</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res :&gt;&gt; '</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>default<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="处理react和vue"><a href="#处理react和vue" class="header-anchor">#</a> 处理React和Vue</h3> <ul><li><p>处理React(解析JSX语法)</p> <p>安装</p> <div class="language-Shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev @babel/preset-react
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>.babelrc</p> <blockquote><p>注意： <code>env</code> 参数可能很快将被废弃</p></blockquote> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>配置完webpack中配置了'babel-loader'，babel-loader会使用@babel/preset-react 去解析JSX语法</p></li> <li><p>处理vue(vue-loader)</p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/06152993283e4da78e73ba97916e4a2f~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p></li></ul> <p>参考：https://www.babeljs.cn/docs/babel-preset-react</p> <ul><li>处理Vue</li></ul> <h3 id="module-chunk-bundle的区别"><a href="#module-chunk-bundle的区别" class="header-anchor">#</a> module chunk bundle的区别</h3> <ol><li><p>module-各个源码文件，webpack中一切皆模块
（能被引入的文件都是模块，不管是什么类型，比如css  js 图片）</p></li> <li><p>chunk-多模块合并成的，如entry、import() 、splitChunk都可以生成chunk</p></li> <li><p>bundle-最终的输出文件</p></li></ol> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/203f59619ab143769f3d87cf73fe2e7c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h2 id="优化构建速度"><a href="#优化构建速度" class="header-anchor">#</a> 优化构建速度</h2> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d54e180797ab4bb5abe3d55ad1e6bc21~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <p>让你聊聊webpack的时候，不要跟背书式回答问题，要通过分析问题的思路来回答问题</p> <h3 id="优化babel-loader-一般用于开发环境"><a href="#优化babel-loader-一般用于开发环境" class="header-anchor">#</a> 优化babel-loader（一般用于开发环境）</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">// 优化： 1. 开启缓存 2. include exclude明确范围，写其中一个即可以</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                loader<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 开启缓存</span>
                include<span class="token operator">:</span> srcPath<span class="token punctuation">,</span>
                <span class="token comment">// exclude: /node_modules/</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>开启缓存: 用cacheDirectory，只要ES6代码没变，就不会重新编译，会缓存下来
第二次编译时，没改的部分使用缓存</p> <h3 id="ignoreplugin-可用于生产环境"><a href="#ignoreplugin-可用于生产环境" class="header-anchor">#</a> IgnorePlugin（可用于生产环境）</h3> <p>避免一些模块引入。如果不用IgnorePlugin，可能会出现一些问题，比如打包的体积太大，打包慢</p> <p>例如：moment会支持多语言，如何只引入中文模块？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 忽略 moment 下的全部 /locale目录 </span>
<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.\/locale</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moment</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>按需引入</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 业务代码中动态引入语言包 </span>
<span class="token keyword">import</span> <span class="token string">'moment/locale/zh-cn'</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="noparse-忽略大型的-library-可以提高构建性能-可用于生产环境"><a href="#noparse-忽略大型的-library-可以提高构建性能-可用于生产环境" class="header-anchor">#</a> noParse(忽略大型的 library 可以提高构建性能)（可用于生产环境）</h3> <p>noParse避免重复打包 module: { noParse: [/react.min.js$/] }</p> <p>IgnorePlugin和noParse区别：</p> <ul><li>IgnorePlugin直接不引入，代码中没有</li> <li>noParse(类似vue.min.js已经模块化处理过)引入，但不打包</li></ul> <h3 id="happypack-多进程打包-可用于生产环境"><a href="#happypack-多进程打包-可用于生产环境" class="header-anchor">#</a> happyPack 多进程打包（可用于生产环境）</h3> <p>JS单线程，开启多进程打包
提高构建速度（特别是多核CPU）</p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a95a298befb1412fa33a115b874a1eda~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f936666cfddb4a87b7c5d24594cb5c47~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="paralleluglifyplugin优化压缩-可用于生产环境"><a href="#paralleluglifyplugin优化压缩-可用于生产环境" class="header-anchor">#</a> ParallelUglifyPlugin优化压缩（可用于生产环境）</h3> <p>必须用于生产环境，压缩代码</p> <ul><li>webpack内置Uglify工具压缩JS</li> <li>JS单线程，开启多线程压缩更快</li> <li>和happypack同理</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ParallelUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 传递给 UglifyJS 的参数</span>
        <span class="token comment">// （还是使用 UglifyJS 压缩，只不过帮助开启了多进程）</span>
        uglifyJS<span class="token operator">:</span> <span class="token punctuation">{</span>
            output<span class="token operator">:</span> <span class="token punctuation">{</span>
                beautify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 最紧凑的输出</span>
                comments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 删除所有的注释</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            compress<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// 删除所有的 `console` 语句，可以兼容ie浏览器</span>
                drop_console<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token comment">// 内嵌定义了但是只用到一次的变量</span>
                collapse_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token comment">// 提取出出现多次但是没有定义成变量去引用的静态值</span>
                reduce_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li>关于是否需要开启多进程
<ul><li>项目较大的时候，开启会加快打包</li> <li>项目较小的时候，开启会变慢，因为多进程开销</li></ul></li></ul> <h3 id="自动刷新-不可用于生产环境"><a href="#自动刷新-不可用于生产环境" class="header-anchor">#</a> 自动刷新（不可用于生产环境）</h3> <p>一般不用自我配置，因为开发的时候一般会用devServer，会自动开启自动刷新</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 一般不用自我配置，因为开发的时候一般会用devServer，会自动开启自动刷新</span>
    <span class="token comment">// watch: true, // 开启监听，默认为 false</span>
    <span class="token comment">// // 开启监听后，webpack-dev-server 会自动开启刷新浏览器</span>

	<span class="token comment">// // 监听配置</span>
    <span class="token comment">// watchOptions: {</span>
    <span class="token comment">//     ignored: /node_modules/, // 忽略哪些</span>
    <span class="token comment">//     // 监听到变化发生后会等300ms再去执行动作，防止文件更新太快导致重新编译频率太高</span>
    <span class="token comment">//     // 默认为 300ms</span>
    <span class="token comment">//     aggregateTimeout: 300,</span>
    <span class="token comment">//     // 判断文件是否发生变化是通过不停的去询问系统指定文件有没有变化实现的</span>
    <span class="token comment">//     // 默认每隔1000毫秒询问一次</span>
    <span class="token comment">//     poll: 1000</span>
    <span class="token comment">// }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="热更新-不可用于生产环境"><a href="#热更新-不可用于生产环境" class="header-anchor">#</a> 热更新（不可用于生产环境）</h3> <p>区别</p> <ul><li>自动刷新：整个网页全部刷新，速度慢，状态会丢失（比如填写表单时，表单内容会丢失，或者路由跳转了很多层，网页刷新后会跳到首页）</li> <li>热更新：新代码生效，网页不刷新，状态不丢失</li></ul> <p>开启热更新配置</p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c6d7212a6bd47309d6590e475909c02~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <p>配置哪些模块需要热更新</p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53af7ab2bb774bcdbf28d4c9485fa2c8~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="dllplugin拆分-bundles-不可用于生产环境"><a href="#dllplugin拆分-bundles-不可用于生产环境" class="header-anchor">#</a> DllPlugin拆分 bundles（不可用于生产环境）</h3> <ul><li><p>前端框架如vue React 体积大，构建慢</p></li> <li><p>较稳定，不常升级</p></li> <li><p>同一个版本只需要构建一次，不用每次都重新构建</p></li> <li><p>webpack已内置DllPlugin支持</p></li> <li><p>DllPlugin 打包出dll文件</p> <ul><li>打包后产出文件
<ul><li>react.dll.js 打包后的内容</li> <li>react.manifest.json 索引
配置参考</li></ul></li></ul></li></ul> <p>webpack.dll.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> DllPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/DllPlugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> srcPath<span class="token punctuation">,</span> distPath <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./paths'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  <span class="token comment">// JS 执行入口文件</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 把 React 相关模块的放到一个单独的动态链接库</span>
    react<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'react-dom'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 输出的动态链接库的文件名称，[name] 代表当前动态链接库的名称，</span>
    <span class="token comment">// 也就是 entry 中配置的 react 和 polyfill</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    <span class="token comment">// 输出的文件都放到 dist 目录下</span>
    path<span class="token operator">:</span> distPath<span class="token punctuation">,</span>
    <span class="token comment">// 存放动态链接库的全局变量名称，例如对应 react 来说就是 _dll_react</span>
    <span class="token comment">// 之所以在前面加上 _dll_ 是为了防止全局变量冲突</span>
    library<span class="token operator">:</span> <span class="token string">'_dll_[name]'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 接入 DllPlugin</span>
    <span class="token keyword">new</span> <span class="token class-name">DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 动态链接库的全局变量名称，需要和 output.library 中保持一致</span>
      <span class="token comment">// 该字段的值也就是输出的 manifest.json 文件 中 name 字段的值</span>
      <span class="token comment">// 例如 react.manifest.json 中就有 &quot;name&quot;: &quot;_dll_react&quot;</span>
      name<span class="token operator">:</span> <span class="token string">'_dll_[name]'</span><span class="token punctuation">,</span>
      <span class="token comment">// 描述动态链接库的 manifest.json 文件输出时的文件名称</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>distPath<span class="token punctuation">,</span> <span class="token string">'[name].manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ul><li>DllReferencePlugin 使用dll文件
配置</li></ul> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0bcaaf01df1a4a5983a782693a6b4050~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h2 id="优化产出代码"><a href="#优化产出代码" class="header-anchor">#</a> 优化产出代码</h2> <ul><li>体积更小</li> <li>合理分包，不重复加载</li> <li>速度更快，内存使用更少</li></ul> <h3 id="使用生产环境"><a href="#使用生产环境" class="header-anchor">#</a> 使用生产环境</h3> <p>mode: 'production',打包生产环境代码</p> <ul><li>自动开启代码压缩</li> <li>Vue React等框架会自动删掉调试代码(如开发环境的warning)</li> <li>自动开启Tree-Shaking(摇晃树，把没有用的东西摇掉)</li></ul> <p>什么是Tree-Shaking</p> <ul><li>js和css都可以treeShaking</li> <li>ES6 Module才能让tree-shaking生效，commonjs不可以。因为ES6 Module是静态引入，Commonjs是动态引入</li></ul> <p>tree-shaking会把一些没有用到的函数删除</p> <h3 id="小图片使用base64编码"><a href="#小图片使用base64编码" class="header-anchor">#</a> 小图片使用base64编码</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code> module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// 图片 - 考虑 base64 编码的情况</span>
        <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpg|jpeg|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">{</span>
                loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 小于 5kb 的图片用 base64 格式产出</span>
                    <span class="token comment">// 否则，依然延用 file-loader 的形式，产出 url 格式</span>
                    limit<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>

                    <span class="token comment">// 打包到 img 目录下</span>
                    outputPath<span class="token operator">:</span> <span class="token string">'/img1/'</span><span class="token punctuation">,</span>

                    <span class="token comment">// 设置图片的 cdn 地址（也可以统一在外面的 output 中设置，那将作用于所有静态资源）</span>
                    <span class="token comment">// publicPath: 'http://cdn.abc.com'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="bundle加hash"><a href="#bundle加hash" class="header-anchor">#</a> bundle加hash</h3> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/786d91edc1e24f08b472c1d9a440743b~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="提取公共代码"><a href="#提取公共代码" class="header-anchor">#</a> 提取公共代码</h3> <p>splitChunks</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a5d2172b1f6c44bc9a01fd5a9fd682d1~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="懒加载"><a href="#懒加载" class="header-anchor">#</a> 懒加载</h3> <h3 id="使用cdn加速"><a href="#使用cdn加速" class="header-anchor">#</a> 使用CDN加速</h3> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/caadc5cdd1c04a1d9e0dc064e74c489a~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h3 id="webpack的scope-hosting-作用域提升"><a href="#webpack的scope-hosting-作用域提升" class="header-anchor">#</a> webpack的scope hosting(作用域提升)</h3> <p>默认情况不开启scope hosting</p> <ul><li>产生多个函数，每个函数都有一个作用域，对js代码执行和内存消耗非常不友好</li></ul> <p>开启后</p> <ul><li>多个函数合并为一个函数，作用域减少</li> <li>代码体积更小</li> <li>创建函数作用域更少</li> <li>代码可读性更好</li></ul> <p>来自：<a href="https://webpack.wuhaolin.cn/4%E4%BC%98%E5%8C%96/4-14%E5%BC%80%E5%90%AFScopeHoisting.html" target="_blank" rel="noopener noreferrer">深入浅出webpack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>同时，考虑到 Scope Hoisting 依赖源码需采用 ES6 模块化语法，还需要配置 <code>mainFields</code>。 原因在 <a href="https://webpack.wuhaolin.cn/4%E4%BC%98%E5%8C%96/4-10%E4%BD%BF%E7%94%A8TreeShaking.html" target="_blank" rel="noopener noreferrer">4-10 使用 TreeShaking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中提到过：因为大部分 Npm 中的第三方库采用了 CommonJS 语法，但部分库会同时提供 ES6 模块化的代码，为了充分发挥 Scope Hoisting 的作用，需要增加以下配置：</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
  resolve: {
    // 针对 Npm 中的第三方模块优先采用 jsnext:main 中指向的 ES6 模块化语法的文件
    mainFields: ['jsnext:main', 'browser', 'main']
  },
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d35f8d0f0de4466b299fd8649e779d4~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p> <h2 id="webpack4升级-webpack5-以及周边插件后"><a href="#webpack4升级-webpack5-以及周边插件后" class="header-anchor">#</a> webpack4升级 webpack5 以及周边插件后</h2> <h1 id="babel"><a href="#babel" class="header-anchor">#</a> Babel</h1> <h2 id="babel作用"><a href="#babel作用" class="header-anchor">#</a> Babel作用</h2> <p>ES6模块化，浏览器并不完全支持，需要通过Babel来编译成ES5</p> <p>例如：将<code>let</code> <code>const</code> 编译为<code>var</code>；将<code>class</code>编译为<code>function</code></p> <h2 id="环境搭建和基本配置"><a href="#环境搭建和基本配置" class="header-anchor">#</a> 环境搭建和基本配置</h2> <p>package.json</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@babel/cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/preset-env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.5&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@babel/polyfill&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/runtime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.7.5&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>.babelrc 基本配置</p> <div class="language-babelrc line-numbers-mode"><pre class="language-text"><code>{
    &quot;presets&quot;: [
        [
            &quot;@babel/preset-env&quot;
        ]
    ],
    &quot;plugins&quot;: [
    ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="presets"><a href="#presets" class="header-anchor">#</a> presets</h2> <ul><li>@babel/preset-env是很多plugin的一个集合，可以转换ES6 7 8语法
<ul><li>是一个babel插件的集合，预设置，代替我们写很多的plugins</li></ul></li> <li>@babel/preset-flow</li> <li>@babel/preset-react(转换jsx语法)</li> <li>@babel/preset-typescript(转换ts语法)</li></ul> <h2 id="babel和babel-loader的区别"><a href="#babel和babel-loader的区别" class="header-anchor">#</a> babel和babel-loader的区别</h2> <ul><li>babel是编译ES6的核心工具</li> <li>babel-loader是用babel封装后，将babel用于webpack打包流程。类似less和less-loader</li></ul> <h2 id="babel-polyfill"><a href="#babel-polyfill" class="header-anchor">#</a> babel-polyfill</h2> <h3 id="什么是babel-polyfill"><a href="#什么是babel-polyfill" class="header-anchor">#</a> 什么是babel-polyfill？</h3> <p>对一些浏览器不支持的函数做补丁或者兼容</p> <ul><li>babel只负责解析语法，不处理API,也不管模块化（webpack处理模块化）</li> <li>webpack把babel-polyfill引入进来，babel处理完交给webpack。polyfill解析Promise和includes语法，API就可以在浏览器正常运行</li></ul> <h3 id="babel-polyfill与core-js关系"><a href="#babel-polyfill与core-js关系" class="header-anchor">#</a> @babel/polyfill与core-js关系</h3> <p><code>@babel/polyfill</code>可以看作是：<code>core-js</code>加<code>regenerator-runtime</code>。</p> <blockquote><p><code>regenerator-runtime</code>是<code>generator</code>以及<code>async/await</code>的运行时依赖</p></blockquote> <p>单独使用<code>@babel/polyfill</code>会将<code>core-js</code>全量导入，造成项目打包体积过大。</p> <blockquote><p>从Babel v7.4.0[5]开始，<code>@babel/polyfill</code>被废弃了，可以直接引用<code>core-js</code>与<code>regenerator-runtime</code>替代</p></blockquote> <p>为了解决全量引入<code>core-js</code>造成打包体积过大的问题，我们需要配合使用<code>@babel/preset-env</code>。</p> <h3 id="babel-polyfill如何按需引入"><a href="#babel-polyfill如何按需引入" class="header-anchor">#</a> babel-polyfill如何按需引入</h3> <h4 id="为什么要按需引入"><a href="#为什么要按需引入" class="header-anchor">#</a> 为什么要按需引入</h4> <p>babel-polyfill文件较大，如果只使用一部分功能，无需全部引入。（已废弃原因）</p> <h2 id="babel-runtime"><a href="#babel-runtime" class="header-anchor">#</a> babel-runtime</h2> <h4 id="babel-polyfill的问题"><a href="#babel-polyfill的问题" class="header-anchor">#</a> babel-polyfill的问题</h4> <ul><li>会污染全局环境。如果做一个独立的系统，则没问题，如果做一个第三方库，就会可能产生与使用方命名冲突问题。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>babel-runtime： 避免自行引入polyfill时导致的污染全局命名空间的问题
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>@babel/plugin-transform-runtime 的作用是将 helper 和 polyfill 都改为从一个统一的地方引入，并且引入的对象和全局变量是完全隔离的，这样解决了上面的两个问题。</p></blockquote> <p>参考</p> <ul><li>https://zhuanlan.zhihu.com/p/147083132</li></ul> <h1 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h1> <h2 id="前端为什么需要打包构建"><a href="#前端为什么需要打包构建" class="header-anchor">#</a> 前端为什么需要打包构建</h2> <h3 id="代码层面"><a href="#代码层面" class="header-anchor">#</a> 代码层面</h3> <ul><li>打包体积会更小（tree-shaking，代码压缩，合并），加载速度更快</li> <li>编译高级语言语法（TS，ES6，less，scss，模块化）</li> <li>兼容性和错误提示（babel-polyfill、postcss、eslint）</li></ul> <h3 id="打包流程、前端工程化方面"><a href="#打包流程、前端工程化方面" class="header-anchor">#</a> 打包流程、前端工程化方面</h3> <ul><li>統一、高效的开发环境</li> <li>统一的构建流程和产出标准</li> <li>集成公司的构建规范（提测、上线等）</li></ul> <h2 id="module-chunk-bundle的区别-2"><a href="#module-chunk-bundle的区别-2" class="header-anchor">#</a> module chunk bundle的区别</h2> <h2 id="loader和plugin的区别"><a href="#loader和plugin的区别" class="header-anchor">#</a> loader和plugin的区别</h2> <ul><li>loader模块转换器 如less -&gt; css</li> <li>plugin扩展插件 如HtmlWebpackPlugin</li></ul> <h2 id="常见的loader和plugin有哪些"><a href="#常见的loader和plugin有哪些" class="header-anchor">#</a> 常见的loader和plugin有哪些</h2> <h2 id="babel和webpack的区别"><a href="#babel和webpack的区别" class="header-anchor">#</a> babel和webpack的区别</h2> <ul><li>babel-js新语法编译工具，不关心模块化</li> <li>webpack是打包构建工具，是多个loader plugin的集合</li></ul> <h2 id="如何产出一个lib"><a href="#如何产出一个lib" class="header-anchor">#</a> 如何产出一个lib</h2> <h2 id="babel-polyfill和babel-runtime的区别"><a href="#babel-polyfill和babel-runtime的区别" class="header-anchor">#</a> babel-polyfill和babel-runtime的区别</h2> <ul><li>babel-polyfill会污染全局</li> <li>babel-runtime不会污染全局</li> <li>开发第三方lib要用babel-runtime，避免与使用方产生冲突</li></ul> <h2 id="webpack如何使用懒加载"><a href="#webpack如何使用懒加载" class="header-anchor">#</a> webpack如何使用懒加载</h2> <ul><li>import()</li> <li>结合Vue React 异步组件</li> <li>结合Vue-router React-router异步加载路由</li></ul> <h2 id="为何proxy不能被polyfill"><a href="#为何proxy不能被polyfill" class="header-anchor">#</a> 为何Proxy不能被Polyfill</h2> <p>因为(function callback是es5语法)</p> <ul><li>Class可以用function模拟</li> <li>Promise可以用callback来模拟</li> <li>但Proxy的功能用Object.defineProperty无法模拟</li></ul> <blockquote><p>Polyfill 是一块代码（通常是 Web 上的 JavaScript），用来为旧浏览器提供它没有原生支持的较新的功能。
proxy没有任何现成的语法可以模拟到，所以无法Polyfill</p></blockquote> <h2 id="常见性能优化方法"><a href="#常见性能优化方法" class="header-anchor">#</a> 常见性能优化方法</h2> <p>从<code>构建速度</code>和<code>产出代码</code>两个方面分析</p> <h3 id="优化构建速度-2"><a href="#优化构建速度-2" class="header-anchor">#</a> 优化构建速度</h3> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <ul><li>可用于生产环境的
<ul><li>优化babel-loader</li> <li>IgnorePlugin</li> <li>noParse</li> <li>happyPack多进程打包</li> <li>ParallelUgifyPlugin优化压缩</li></ul></li> <li>不能用于生产环境
<ul><li>自动更新</li> <li>热更新</li> <li>DllPlugin</li></ul></li></ul> <p>特别强调：热更新万万不能用于生产环境，在代码中写的热更新范围，在生产打包时一定要删掉，否则生产环境会有问题！</p> <h3 id="优化产出代码-2"><a href="#优化产出代码-2" class="header-anchor">#</a> 优化产出代码</h3> <ul><li>小图片通过base64方式</li> <li>bundle加hash</li> <li>懒加载</li> <li>提取公共代码</li> <li>使用cdn加速</li> <li>IgnorePlugin</li> <li>使用Production模式</li> <li>开启Scope Hosting</li></ul> <h1 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h1> <ul><li><a href="https://webpack.wuhaolin.cn/" target="_blank" rel="noopener noreferrer">深入浅出webpack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/19/2021, 2:25:23 PM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#为什么需要webpack-webpack作用" class="sidebar-link reco-side-为什么需要webpack-webpack作用" data-v-70334359>为什么需要webpack? webpack作用</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#🤔思考问题" class="sidebar-link reco-side-🤔思考问题" data-v-70334359>🤔思考问题</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#关于webpack5" class="sidebar-link reco-side-关于webpack5" data-v-70334359>关于webpack5</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#基本配置" class="sidebar-link reco-side-基本配置" data-v-70334359>基本配置</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#安装配置" class="sidebar-link reco-side-安装配置" data-v-70334359>安装配置</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#拆分配置和merge" class="sidebar-link reco-side-拆分配置和merge" data-v-70334359>拆分配置和merge</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#启动本地服务-dev-server-命令" class="sidebar-link reco-side-启动本地服务-dev-server-命令" data-v-70334359>启动本地服务 dev-server 命令</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#module" class="sidebar-link reco-side-module" data-v-70334359>Module</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#devserver" class="sidebar-link reco-side-devserver" data-v-70334359>devServer</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#解析图片文件" class="sidebar-link reco-side-解析图片文件" data-v-70334359>解析图片文件</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#常见loader和plugin" class="sidebar-link reco-side-常见loader和plugin" data-v-70334359>常见loader和plugin</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#处理样式文件" class="sidebar-link reco-side-处理样式文件" data-v-70334359>处理样式文件</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#高级配置" class="sidebar-link reco-side-高级配置" data-v-70334359>高级配置</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#配置多入口" class="sidebar-link reco-side-配置多入口" data-v-70334359>配置多入口</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#抽离和压缩css-重要" class="sidebar-link reco-side-抽离和压缩css-重要" data-v-70334359>抽离和压缩CSS(重要)</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#抽离公共代码-重要" class="sidebar-link reco-side-抽离公共代码-重要" data-v-70334359>抽离公共代码(重要)</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#webpack如何实现异步加载js-懒加载-重要" class="sidebar-link reco-side-webpack如何实现异步加载js-懒加载-重要" data-v-70334359>webpack如何实现异步加载JS(懒加载)(重要)</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#处理react和vue" class="sidebar-link reco-side-处理react和vue" data-v-70334359>处理React和Vue</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#module-chunk-bundle的区别" class="sidebar-link reco-side-module-chunk-bundle的区别" data-v-70334359>module chunk bundle的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#优化构建速度" class="sidebar-link reco-side-优化构建速度" data-v-70334359>优化构建速度</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#优化babel-loader-一般用于开发环境" class="sidebar-link reco-side-优化babel-loader-一般用于开发环境" data-v-70334359>优化babel-loader（一般用于开发环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#ignoreplugin-可用于生产环境" class="sidebar-link reco-side-ignoreplugin-可用于生产环境" data-v-70334359>IgnorePlugin（可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#noparse-忽略大型的-library-可以提高构建性能-可用于生产环境" class="sidebar-link reco-side-noparse-忽略大型的-library-可以提高构建性能-可用于生产环境" data-v-70334359>noParse(忽略大型的 library 可以提高构建性能)（可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#happypack-多进程打包-可用于生产环境" class="sidebar-link reco-side-happypack-多进程打包-可用于生产环境" data-v-70334359>happyPack 多进程打包（可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#paralleluglifyplugin优化压缩-可用于生产环境" class="sidebar-link reco-side-paralleluglifyplugin优化压缩-可用于生产环境" data-v-70334359>ParallelUglifyPlugin优化压缩（可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#自动刷新-不可用于生产环境" class="sidebar-link reco-side-自动刷新-不可用于生产环境" data-v-70334359>自动刷新（不可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#热更新-不可用于生产环境" class="sidebar-link reco-side-热更新-不可用于生产环境" data-v-70334359>热更新（不可用于生产环境）</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#dllplugin拆分-bundles-不可用于生产环境" class="sidebar-link reco-side-dllplugin拆分-bundles-不可用于生产环境" data-v-70334359>DllPlugin拆分 bundles（不可用于生产环境）</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#优化产出代码" class="sidebar-link reco-side-优化产出代码" data-v-70334359>优化产出代码</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#使用生产环境" class="sidebar-link reco-side-使用生产环境" data-v-70334359>使用生产环境</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#小图片使用base64编码" class="sidebar-link reco-side-小图片使用base64编码" data-v-70334359>小图片使用base64编码</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#bundle加hash" class="sidebar-link reco-side-bundle加hash" data-v-70334359>bundle加hash</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#提取公共代码" class="sidebar-link reco-side-提取公共代码" data-v-70334359>提取公共代码</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#懒加载" class="sidebar-link reco-side-懒加载" data-v-70334359>懒加载</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#使用cdn加速" class="sidebar-link reco-side-使用cdn加速" data-v-70334359>使用CDN加速</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#webpack的scope-hosting-作用域提升" class="sidebar-link reco-side-webpack的scope-hosting-作用域提升" data-v-70334359>webpack的scope hosting(作用域提升)</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#webpack4升级-webpack5-以及周边插件后" class="sidebar-link reco-side-webpack4升级-webpack5-以及周边插件后" data-v-70334359>webpack4升级 webpack5 以及周边插件后</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel作用" class="sidebar-link reco-side-babel作用" data-v-70334359>Babel作用</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#环境搭建和基本配置" class="sidebar-link reco-side-环境搭建和基本配置" data-v-70334359>环境搭建和基本配置</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#presets" class="sidebar-link reco-side-presets" data-v-70334359>presets</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel和babel-loader的区别" class="sidebar-link reco-side-babel和babel-loader的区别" data-v-70334359>babel和babel-loader的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel-polyfill" class="sidebar-link reco-side-babel-polyfill" data-v-70334359>babel-polyfill</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#什么是babel-polyfill" class="sidebar-link reco-side-什么是babel-polyfill" data-v-70334359>什么是babel-polyfill？</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel-polyfill与core-js关系" class="sidebar-link reco-side-babel-polyfill与core-js关系" data-v-70334359>@babel/polyfill与core-js关系</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel-polyfill如何按需引入" class="sidebar-link reco-side-babel-polyfill如何按需引入" data-v-70334359>babel-polyfill如何按需引入</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel-runtime" class="sidebar-link reco-side-babel-runtime" data-v-70334359>babel-runtime</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#前端为什么需要打包构建" class="sidebar-link reco-side-前端为什么需要打包构建" data-v-70334359>前端为什么需要打包构建</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#代码层面" class="sidebar-link reco-side-代码层面" data-v-70334359>代码层面</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#打包流程、前端工程化方面" class="sidebar-link reco-side-打包流程、前端工程化方面" data-v-70334359>打包流程、前端工程化方面</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#module-chunk-bundle的区别-2" class="sidebar-link reco-side-module-chunk-bundle的区别-2" data-v-70334359>module chunk bundle的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#loader和plugin的区别" class="sidebar-link reco-side-loader和plugin的区别" data-v-70334359>loader和plugin的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#常见的loader和plugin有哪些" class="sidebar-link reco-side-常见的loader和plugin有哪些" data-v-70334359>常见的loader和plugin有哪些</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel和webpack的区别" class="sidebar-link reco-side-babel和webpack的区别" data-v-70334359>babel和webpack的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#如何产出一个lib" class="sidebar-link reco-side-如何产出一个lib" data-v-70334359>如何产出一个lib</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#babel-polyfill和babel-runtime的区别" class="sidebar-link reco-side-babel-polyfill和babel-runtime的区别" data-v-70334359>babel-polyfill和babel-runtime的区别</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#webpack如何使用懒加载" class="sidebar-link reco-side-webpack如何使用懒加载" data-v-70334359>webpack如何使用懒加载</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#为何proxy不能被polyfill" class="sidebar-link reco-side-为何proxy不能被polyfill" data-v-70334359>为何Proxy不能被Polyfill</a></li><li class="level-2" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#常见性能优化方法" class="sidebar-link reco-side-常见性能优化方法" data-v-70334359>常见性能优化方法</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#优化构建速度-2" class="sidebar-link reco-side-优化构建速度-2" data-v-70334359>优化构建速度</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#总结" class="sidebar-link reco-side-总结" data-v-70334359>总结</a></li><li class="level-3" data-v-70334359><a href="/blogs/FE/webpackAndBabel.html#优化产出代码-2" class="sidebar-link reco-side-优化产出代码-2" data-v-70334359>优化产出代码</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.3531c93d.js" defer></script><script src="/assets/js/3.4482be46.js" defer></script><script src="/assets/js/1.336ca81d.js" defer></script><script src="/assets/js/27.bdf61d24.js" defer></script>
  </body>
</html>
