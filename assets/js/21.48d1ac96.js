(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{565:function(t,a,e){"use strict";e.r(a);var s=e(12),v=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"🤔思考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🤔思考"}},[t._v("#")]),t._v(" 🤔思考")]),t._v(" "),e("ul",[e("li",[t._v("http 常见的状态码有哪些")]),t._v(" "),e("li",[t._v("什么是 Restful-API")]),t._v(" "),e("li",[t._v("http 哪些常见 header")]),t._v(" "),e("li",[t._v("http 为何需要缓存")]),t._v(" "),e("li",[t._v("cache-control 是什么意思 - http 强制缓存")]),t._v(" "),e("li",[t._v("Etag 和 Last-Modified 是什么意思 - http 协商缓存")]),t._v(" "),e("li",[t._v("刷新页面对 http 缓存的影响")]),t._v(" "),e("li",[t._v("关于HTTP版本演进，不同版本都解决了什么问题")]),t._v(" "),e("li",[t._v("CDN有用过吗？API可以用CDN吗")]),t._v(" "),e("li",[t._v("何设计缓存方案，既可以首屏快，又可以获取到最新资源")])]),t._v(" "),e("h1",{attrs:{id:"http状态码分类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http状态码分类"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://www.runoob.com/http/http-status-codes.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP状态码分类"),e("OutboundLink")],1)]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("分类")]),t._v(" "),e("th",[t._v("分类描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("1**")]),t._v(" "),e("td",[t._v("信息，服务器收到请求，需要请求者"),e("code",[t._v("继续")]),t._v("执行操作")])]),t._v(" "),e("tr",[e("td",[t._v("2**")]),t._v(" "),e("td",[e("code",[t._v("成功")]),t._v("，操作被成功接收并处理")])]),t._v(" "),e("tr",[e("td",[t._v("3**")]),t._v(" "),e("td",[e("code",[t._v("重定向")]),t._v("，需要进一步的操作以完成请求")])]),t._v(" "),e("tr",[e("td",[t._v("4**")]),t._v(" "),e("td",[e("code",[t._v("客户端错误")]),t._v("，请求包含语法错误或无法完成请求")])]),t._v(" "),e("tr",[e("td",[t._v("5**")]),t._v(" "),e("td",[e("code",[t._v("服务器错误")]),t._v("，服务器处理请求的过程中发生了错误")])])])]),t._v(" "),e("h2",{attrs:{id:"熟悉常见状态码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#熟悉常见状态码"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status",target:"_blank",rel:"noopener noreferrer"}},[t._v("熟悉常见状态码"),e("OutboundLink")],1),t._v("：")]),t._v(" "),e("ul",[e("li",[t._v("200 成功")]),t._v(" "),e("li",[t._v("301 Found 永久重定向（配合Location浏览器自动处理）")]),t._v(" "),e("li",[t._v("302 临时重定向（配合Location浏览器自动处理）\n"),e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c296f2518fe4b528be4f7b5a6f5c1b9~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),e("li",[t._v("304 Not Modified 资源未被修改")]),t._v(" "),e("li",[t._v("400 Bad Request\n"),e("ul",[e("li",[t._v("语义有误，当前请求无法被服务器理解")]),t._v(" "),e("li",[t._v("请求参数有误")])])]),t._v(" "),e("li",[t._v("401 Unauthorized\n"),e("ul",[e("li",[t._v("没有权限。当前请求需要用户验证")])])]),t._v(" "),e("li",[t._v("403 Forbidden\n"),e("ul",[e("li",[t._v("服务器已经理解请求，但是拒绝执行它。")])])]),t._v(" "),e("li",[t._v("404 Not Found 找不到资源")]),t._v(" "),e("li",[t._v("500 Internal Server Error 服务器")]),t._v(" "),e("li",[t._v("502 Bad Gayway\n"),e("ul",[e("li",[t._v("此错误响应表明服务器作为网关需要得到一个处理这个请求的响应，但是得到一个错误的响应。")])])]),t._v(" "),e("li",[t._v("504 Gaywey Timeout\n"),e("ul",[e("li",[t._v("当服务器作为网关，不能及时得到响应时返回此错误代码。")])])])]),t._v(" "),e("h1",{attrs:{id:"什么是-restful-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是-restful-api"}},[t._v("#")]),t._v(" 什么是 Restful-API")]),t._v(" "),e("blockquote",[e("p",[t._v("REST: Representational State Transfer 变现层状态转换")])]),t._v(" "),e("ul",[e("li",[t._v("Restful-API: 一种新的"),e("code",[t._v("API设计方法")]),t._v("。\n"),e("ul",[e("li",[t._v("把每个URI当做"),e("code",[t._v("一个资源")])]),t._v(" "),e("li",[t._v("不使用url参数")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("传统API设计: /api/list?pageIndex=2\nRestful-API设计: /api/list/2\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])]),t._v(" "),e("li",[t._v("传统的API设计: 把每个URI当做"),e("code",[t._v("一个功能")])])]),t._v(" "),e("p",[t._v("如何设计成一个资源")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("不使用参数")])]),t._v(" "),e("li",[e("strong",[t._v("用method表示操作类型")]),t._v(" "),e("ul",[e("li",[t._v("GET 获取数据")]),t._v(" "),e("li",[t._v("POST 新键或更新")]),t._v(" "),e("li",[t._v("PATCH/PUT 更新（修改）")]),t._v(" "),e("li",[t._v("DELETE 删除")])])])]),t._v(" "),e("p",[t._v("对比例子")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("传统API设计")]),t._v(" "),e("ul",[e("li",[t._v("增 post： /api/create-blog")]),t._v(" "),e("li",[t._v("改 post： /api/update-blog?id=2")]),t._v(" "),e("li",[t._v("查 get： /api/get-blog?id=2")])])]),t._v(" "),e("li",[e("p",[t._v("Restful-API设计")]),t._v(" "),e("ul",[e("li",[t._v("增 post: /api/blog")]),t._v(" "),e("li",[t._v("改 put/patch: /api/blog/2")]),t._v(" "),e("li",[t._v("查 get: /api/blog/2")])])])]),t._v(" "),e("p",[e("strong",[t._v("学会设计API")])]),t._v(" "),e("p",[t._v("参考资料")]),t._v(" "),e("ul",[e("li",[t._v("https://www.ruanyifeng.com/blog/2014/05/restful_api.html")]),t._v(" "),e("li",[t._v("https://www.ruanyifeng.com/blog/2011/09/restful.html")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.google.com.hk/search?q=API+first",target:"_blank",rel:"noopener noreferrer"}},[t._v("设计思想API first"),e("OutboundLink")],1)])]),t._v(" "),e("h1",{attrs:{id:"常见header"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见header"}},[t._v("#")]),t._v(" 常见header")]),t._v(" "),e("p",[e("strong",[t._v("根据不同上下文，可将消息头分为：")])]),t._v(" "),e("ul",[e("li",[t._v("Request headers")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('GET /home.html HTTP/1.1\nHost: developer.mozilla.org\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:50.0) Gecko/20100101 Firefox/50.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://developer.mozilla.org/testpage.html\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Mon, 18 Jul 2016 02:36:04 GMT\nIf-None-Match: "c561c68d0ba92bbeb8b0fff2a9199f722e3a621a"\nCache-Control: max-age=0\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br")])]),e("ul",[e("li",[t._v("Response headers")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('200 OK\nAccess-Control-Allow-Origin: *\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Type: text/html; charset=utf-8\nDate: Mon, 18 Jul 2016 16:06:00 GMT\nEtag: "c561c68d0ba92bbeb8b0f612a9199f722e3a621a"\nKeep-Alive: timeout=5, max=997\nLast-Modified: Mon, 18 Jul 2016 02:36:04 GMT\nServer: Apache\nSet-Cookie: mykey=myvalue; expires=Mon, 17-Jul-2017 16:06:00 GMT; Max-Age=31449600; Path=/; secure\nTransfer-Encoding: chunked\nVary: Cookie, Accept-Encoding\nX-Backend-Server: developer2.webapp.scl3.mozilla.com\nX-Cache-Info: not cacheable; meta data too large\nX-kuma-revision: 1085259\nx-frame-options: DENY\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br")])]),e("h2",{attrs:{id:"request-headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#request-headers"}},[t._v("#")]),t._v(" Request headers")]),t._v(" "),e("ul",[e("li",[t._v("Accept 浏览器可以接受的数据格式")]),t._v(" "),e("li",[t._v("Accept-Encode 浏览器可接收压缩算法")]),t._v(" "),e("li",[t._v("Accept-Language 浏览器可接收的语言")]),t._v(" "),e("li",[t._v("Connection\n"),e("blockquote",[e("p",[t._v("决定当前的事务完成后，是否会关闭网络连接。如果该值是“keep-alive”，网络连接就是持久的，不会关闭，使得对同一个服务器的请求可以继续在该连接上完成。")])])]),t._v(" "),e("li",[t._v("Cookie 存储")]),t._v(" "),e("li",[t._v("Host 域名")]),t._v(" "),e("li",[t._v("User-Agent 浏览器信息")]),t._v(" "),e("li",[t._v("Content-type 发送数据的格式 如application/json")]),t._v(" "),e("li",[t._v("If-Modified-Since")]),t._v(" "),e("li",[t._v("If-None-Match")]),t._v(" "),e("li",[t._v("Cache-Control")])]),t._v(" "),e("h2",{attrs:{id:"response-headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#response-headers"}},[t._v("#")]),t._v(" Response headers")]),t._v(" "),e("ul",[e("li",[t._v("Content-type 返回数据的格式 如application/json")]),t._v(" "),e("li",[t._v("Content-length 返回数据的大小 单位为字节")]),t._v(" "),e("li",[t._v("Content-Encoding 返回数据的压缩算法")]),t._v(" "),e("li",[t._v("Set-Cookie 服务端向客户端发送cookie")]),t._v(" "),e("li",[t._v("Access-Control-Origin-Allow 指定允许资源共享的origin")]),t._v(" "),e("li",[t._v("Etag")]),t._v(" "),e("li",[t._v("Last-Modified")])]),t._v(" "),e("h2",{attrs:{id:"缓存headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存headers"}},[t._v("#")]),t._v(" 缓存headers")]),t._v(" "),e("ul",[e("li",[t._v("Catch-Control     Expires")]),t._v(" "),e("li",[t._v("If-None-Match     Etag")]),t._v(" "),e("li",[t._v("If-Modified-Since Last-Modified")])]),t._v(" "),e("h2",{attrs:{id:"自定义headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自定义headers"}},[t._v("#")]),t._v(" 自定义headers")]),t._v(" "),e("h1",{attrs:{id:"http缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http缓存"}},[t._v("#")]),t._v(" HTTP缓存")]),t._v(" "),e("h2",{attrs:{id:"强制缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#强制缓存"}},[t._v("#")]),t._v(" 强制缓存")]),t._v(" "),e("ul",[e("li",[t._v("expires 已被 Cache-Control替换\n"),e("ul",[e("li",[t._v("判断缓存是否过期 Cache-Control: max-age=31536000（单位是秒）")])])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc842412432444e7a95db9e662ba7df0~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Cache-Control取值")]),t._v(" "),e("ul",[e("li",[t._v("max-age 失效时间 单位秒")]),t._v(" "),e("li",[t._v("no-cache 使用no-cache指令的目的是为了防止从缓存中返回过期的资源。\n"),e("blockquote",[e("p",[e("code",[t._v("no-cache从字面意义上很容易误解为不缓存")]),t._v("，但是no-cache代表不缓存过期的资源，缓存会向服务器进行有效处理确认之后处理资源，更确切的说，no-cache应该是\ndo-not-serve-from-cache-without-revalidation")]),t._v(" "),e("p",[t._v("而no-store才是真正的不进行缓存。")]),t._v(" "),e("p",[t._v("使用no-cache的目的就是为了防止从缓存中获取过期的资源。")]),t._v(" "),e("p",[t._v("原文链接：https://blog.csdn.net/mymilkbottles/article/details/69060193")])])]),t._v(" "),e("li",[t._v("no-store 规定缓存不能在本地存储请求或响应的任一部分。")]),t._v(" "),e("li",[t._v("private 只可以缓存在客户端，不可以缓存到服务器，不共享缓存")]),t._v(" "),e("li",[t._v("public 可以缓存在客户端和服务器，共享缓存")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/04b833a0839c485ab2196e51e7ab9cb6~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})])])]),t._v(" "),e("h2",{attrs:{id:"协商缓存-服务端缓存策略-由服务端来判断"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存-服务端缓存策略-由服务端来判断"}},[t._v("#")]),t._v(" 协商缓存（服务端缓存策略，由服务端来判断）")]),t._v(" "),e("h3",{attrs:{id:"etag-和-last-modified区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#etag-和-last-modified区别"}},[t._v("#")]),t._v(" Etag 和 Last-Modified区别")]),t._v(" "),e("ul",[e("li",[t._v("会优先使用Etag")]),t._v(" "),e("li",[t._v("Last-Modified只能精确到秒级别")]),t._v(" "),e("li",[t._v("如果资源被重复生成，而内容不变，则Etag(指纹)更精确")])]),t._v(" "),e("h3",{attrs:{id:"etag"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#etag"}},[t._v("#")]),t._v(" Etag")]),t._v(" "),e("div",{staticClass:"language-mermaid line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-mermaid"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sequenceDiagram")]),t._v("\n浏览器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("服务器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 初次请求\n服务器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("浏览器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回资源，和Etag\n浏览器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("服务器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 再次请求，Request Headers携带if-None-Match\n服务器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("浏览器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回304 或返回新的资源和新的Etag\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("h3",{attrs:{id:"last-modified"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#last-modified"}},[t._v("#")]),t._v(" Last-Modified")]),t._v(" "),e("div",{staticClass:"language-mermaid line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-mermaid"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sequenceDiagram")]),t._v("\n浏览器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("服务器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 初次请求\n服务器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("浏览器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回资源，和Last-Modified\n浏览器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("服务器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 再次请求，Request Headers携带if-Modified-Since\n服务器"),e("span",{pre:!0,attrs:{class:"token arrow operator"}},[t._v("->>")]),t._v("浏览器"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 返回304 或返回新的资源和新的Etag\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("h3",{attrs:{id:"http缓存的流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http缓存的流程"}},[t._v("#")]),t._v(" "),e("strong",[e("code",[t._v("http缓存的流程")])])]),t._v(" "),e("p",[t._v("TODO: 根据哪里判断？浏览器？request header?response header?")]),t._v(" "),e("ol",[e("li",[t._v("判断Cache-Control是否有强制缓存\n"),e("ul",[e("li",[t._v("有\n"),e("ul",[e("li",[t._v("max-age是否过期\n"),e("ul",[e("li",[t._v("过期 -> 2.判断是否有Etag和Last-Modified")]),t._v(" "),e("li",[t._v("无 加载（完）")])])])])]),t._v(" "),e("li",[t._v("无")])])]),t._v(" "),e("li",[t._v("判断是否有Etag和Last-Modified\n"),e("ul",[e("li",[t._v("有\n"),e("ul",[e("li",[t._v("携带if-None-Match和if-Modified-Since向服务器发起请求\n"),e("ul",[e("li",[t._v("判断协商缓存是否有效（通过）\n"),e("ul",[e("li",[t._v("有 304（完）")]),t._v(" "),e("li",[t._v("无 加载（完）")])])])])])])]),t._v(" "),e("li",[t._v("无\n"),e("ul",[e("li",[t._v("正常请求数据 （完）")])])])])])]),t._v(" "),e("h3",{attrs:{id:"刷新页面-不同操作方式对-http-缓存的影响"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#刷新页面-不同操作方式对-http-缓存的影响"}},[t._v("#")]),t._v(" 刷新页面，不同操作方式对 http 缓存的影响")]),t._v(" "),e("ul",[e("li",[t._v("正常操作（一般用户）： 输入url、点击链接、前进后退\n"),e("ul",[e("li",[t._v("强制缓存有效，协商缓存有效")])])]),t._v(" "),e("li",[t._v("手动刷新：F5\n"),e("ul",[e("li",[t._v("强制缓存有效，协商缓存无效（分强制缓存和协商缓存的原因）")])])]),t._v(" "),e("li",[t._v("强制刷新：Ctrl + F5\n"),e("ul",[e("li",[t._v("强制缓存无效，协商缓存无效")])])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2b90e172f954bbf8037cfb678df8589~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f3214d9594494e6fbcbb686f6d7c1615~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e90e6b305af44ecb75eebe4ef0ad40d~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),e("h1",{attrs:{id:"历史版本演进"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#历史版本演进"}},[t._v("#")]),t._v(" 历史版本演进")]),t._v(" "),e("h2",{attrs:{id:"http-1-0、http-1-1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-1-0、http-1-1"}},[t._v("#")]),t._v(" HTTP/1.0、HTTP/1.1")]),t._v(" "),e("p",[t._v("缺点")]),t._v(" "),e("ul",[e("li",[t._v("连接慢，无法跟上迅猛发展的互联网")])]),t._v(" "),e("h2",{attrs:{id:"http2-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http2-0"}},[t._v("#")]),t._v(" HTTP2.0")]),t._v(" "),e("p",[t._v("Google忍受不了HTTP1.1缺点，独立开发自己的浏览器Chrome。")]),t._v(" "),e("p",[t._v("HTTP/2的制定考虑互联网现状")]),t._v(" "),e("ul",[e("li",[t._v("宽带")]),t._v(" "),e("li",[t._v("移动")]),t._v(" "),e("li",[t._v("不安全\n在高度兼容HTTP/1.1的同时在性能改善方面做了很大努力，主要有一下特点:")])]),t._v(" "),e("ol",[e("li",[t._v("二进制协议，不再是纯文本")]),t._v(" "),e("li",[t._v("可发起多个请求，废弃了1.1里的管道")]),t._v(" "),e("li",[t._v("使用专用算法压缩头部，减少数据传输量")]),t._v(" "),e("li",[t._v("允许服务器主动向客户端推送数据")]),t._v(" "),e("li",[t._v("增强了安全性，“事实上”要求加密通信")])]),t._v(" "),e("p",[t._v("HTTP/2基本解决“队头阻塞”问题")]),t._v(" "),e("ul",[e("li",[t._v("头部压缩")]),t._v(" "),e("li",[t._v("二进制分帧")]),t._v(" "),e("li",[t._v("虚拟的“流”与多路复用")])]),t._v(" "),e("p",[t._v("缺点（有缺点，才有演进，HTTP3.0 解决）: 基本上解决队头阻塞，但是没有根本解决队头阻塞")]),t._v(" "),e("blockquote",[e("p",[t._v("客户端用 TCP 发送了三个包，但服务器所在的操作系统只收到了后两个包，第一个包丢了。那么内核里的 TCP 协议栈就只能把已经收到的包暂存起来，“停下”等着客户端重传那个丢失的包，这样就又出现了“队头阻塞”。")]),t._v(" "),e("p",[t._v("由于这种“队头阻塞”是 TCP 协议固有的，所以 HTTP/2 即使设计出再多的“花样”也无法解决。\nhttps://time.geekbang.org/column/article/115564")])]),t._v(" "),e("h2",{attrs:{id:"http3-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http3-0"}},[t._v("#")]),t._v(" HTTP3.0")]),t._v(" "),e("p",[t._v("UDP 是无序的，包之间没有依赖关系，所以就从根本上解决了“队头阻塞”。\n"),e("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6fb97336399a4c5a84476d4ecad45602~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),t._v(" "),e("ul",[e("li",[t._v("HTTP/3 基于 QUIC 协议，完全解决了“队头阻塞”问题，弱网环境下的表现会优于 HTTP/2；")]),t._v(" "),e("li",[t._v("QUIC 是一个新的传输层协议，建立在 UDP 之上，实现了可靠传输；")]),t._v(" "),e("li",[t._v("QUIC 内含了 TLS1.3，只能加密通信，支持 0-RTT 快速建连；")]),t._v(" "),e("li",[t._v("QUIC 的连接使用“不透明”的连接 ID，不绑定在“IP 地址 + 端口”上，支持“连接迁移”；")]),t._v(" "),e("li",[t._v("QUIC 的流与 HTTP/2 的流很相似，但分为双向流和单向流；")]),t._v(" "),e("li",[t._v("HTTP/3 没有指定默认端口号，需要用 HTTP/2 的扩展帧“Alt-Svc”来发现。")])]),t._v(" "),e("blockquote",[e("p",[t._v("比如你下班回家，手机会自动由 4G 切换到 WiFi。这时 IP 地址会发生变化，TCP 就必须重新建立连接。而 QUIC 连接里的两端连接 ID 不会变，所以连接在“逻辑上”没有中断，它就可以在新的 IP 地址上继续使用之前的连接，消除重连的成本，实现连接的无缝迁移。")])]),t._v(" "),e("h1",{attrs:{id:"如何设计缓存方案-既可以首屏快-又可以获取到最新资源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何设计缓存方案-既可以首屏快-又可以获取到最新资源"}},[t._v("#")]),t._v(" 如何设计缓存方案，既可以首屏快，又可以获取到最新资源")]),t._v(" "),e("h1",{attrs:{id:"cdn有用过吗-api可以用cdn吗"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdn有用过吗-api可以用cdn吗"}},[t._v("#")]),t._v(" CDN有用过吗？API可以用CDN吗")]),t._v(" "),e("blockquote",[e("p",[t._v("CDN（Content Delivery Network 或 Content Distribution Network），中文名叫“内容分发网络”。")])]),t._v(" "),e("blockquote",[e("p",[t._v("CDN 的最核心原则是“就近访问”")])]),t._v(" "),e("blockquote",[e("p",[t._v("CDN 就要“分发”源站的“内容”了，用到的就是“缓存代理”技术。")])]),t._v(" "),e("blockquote",[e("p",[t._v("在 CDN 领域里，“内容”其实就是 HTTP 协议里的“资源”，比如"),e("strong",[t._v("超文本、图片、视频、应用程序安装包")]),t._v("等等。")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("资源")]),t._v(" "),e("ul",[e("li",[t._v("静态资源\n"),e("ul",[e("li",[t._v("图片、音频")])])]),t._v(" "),e("li",[t._v("动态资源\n"),e("ul",[e("li",[t._v("动态变化，后台服务器计算生成，每次访问可能都不一样")]),t._v(" "),e("li",[t._v("如果设置了"),e("code",[t._v("Cache-Control")]),t._v("的缓存时间，这段时间就会成为“静态资源”")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("资源按照是否可缓存又分为“静态资源”和“动态资源”。所谓的“静态资源”是指数据内容“静态不变”，任何时候来访问都是一样的，比如图片、音频。所谓的“动态资源”是指数据内容是“动态变化”的，也就是由后台服务计算生成的，每次访问都不一样，比如商品的库存、微博的粉丝数等。")])]),t._v(" "),e("blockquote",[e("p",[t._v("如果动态资源指定了“Cache-Control”，允许缓存短暂的时间，那它在这段时间里也就变成了“静态资源”，可以被 CDN 缓存加速。")])])])]),t._v(" "),e("h2",{attrs:{id:"cdn的负载均衡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdn的负载均衡"}},[t._v("#")]),t._v(" CDN的负载均衡")]),t._v(" "),e("h3",{attrs:{id:"全局负载均衡系统-gslb-global-sever-load-balance"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#全局负载均衡系统-gslb-global-sever-load-balance"}},[t._v("#")]),t._v(" 全局负载均衡系统（GSLB: Global Sever Load Balance）")]),t._v(" "),e("blockquote",[e("p",[t._v("解决的是用户如何"),e("strong",[t._v("找到“最近的”边缘节点")]),t._v("，对整个 CDN 网络进行“负载均衡”。")])]),t._v(" "),e("p",[t._v("实现方式")]),t._v(" "),e("ul",[e("li",[t._v("DNS负载均衡")])]),t._v(" "),e("h3",{attrs:{id:"缓存系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存系统"}},[t._v("#")]),t._v(" 缓存系统")]),t._v(" "),e("p",[t._v("CDN重要概念")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("命中")]),t._v(" 就是指用户访问的资源恰好在缓存系统里，可以直接返回给用户；")]),t._v(" "),e("li",[e("strong",[t._v("回源")]),t._v(" 则正相反，缓存里没有，必须用"),e("strong",[t._v("代理的方式回源站取")]),t._v("。")])]),t._v(" "),e("h3",{attrs:{id:"🤔思考-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#🤔思考-2"}},[t._v("#")]),t._v(" 🤔思考")]),t._v(" "),e("ol",[e("li",[t._v("网站也可以自建同城、异地多处机房，构建集群来提高服务能力，为什么非要选择 CDN 呢？")])]),t._v(" "),e("ul",[e("li",[t._v("自建成本太高")])]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("对于无法缓存的动态资源，你觉得 CDN 也能有加速效果吗？")])]),t._v(" "),e("ul",[e("li",[t._v("cdn一般有"),e("strong",[t._v("专用的高速网络直连源站")]),t._v("，或者是"),e("strong",[t._v("动态路径优化")]),t._v("，所以动态资源回源要比通过公网速度快很多。")])]),t._v(" "),e("p",[t._v("参考：https://time.geekbang.org/column/article/120664")])])}),[],!1,null,null,null);a.default=v.exports}}]);